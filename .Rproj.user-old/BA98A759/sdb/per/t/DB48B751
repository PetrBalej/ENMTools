{
    "collab_server" : "",
    "contents" : "#' Takes a set of points, a buffer radius, a sample size, and a mask and returns\n#' randomly sampled points from within that buffer radius.\n\n#' Code modified from Elith and Hijmans SDM with R tutorial\n#'\n#' @param species An enmtools.species or enmtools.clade object\n#' @param env A raster stack of environmental variables\n#'\n#' @export add.env\n\n\nadd.env <- function(species, env){\n\n  if(!any(c(\"RasterLayer\", \"RasterStack\", \"raster\", \"RasterBrick\") %in% class(env))){\n    stop(\"Argument env must be a raster, RasterLayer, or RasterStack object!\")\n  }\n\n  if(\"enmtools.species\" %in% class(species)){\n\n    # Adding env data to a single species\n    cat(paste(\"Adding environmental data to species\", species$species.name, \"\\n\"))\n    if(class(species$presence.points) %in% c(\"data.frame\", \"matrix\")){\n      cat(\"\\tProcessing presence points...\\n\")\n\n      # Have to assign names manually because otherwise it fails when there's only one env layer\n      names <- c(colnames(species$presence.points), names(env))\n      species$presence.points <- cbind(species$presence.points, extract(env, species$presence.points[,1:2]))\n      colnames(species$presence.points) <- names\n      species$presence.points <- species$presence.points[complete.cases(species$presence.points),]\n    } else {\n      print(\"No presence points, skipping...\\n\")\n    }\n\n    if(class(species$background.points) %in% c(\"data.frame\", \"matrix\")){\n      cat(\"\\tProcessing background points...\\n\")\n\n      names <- c(colnames(species$background.points), names(env))\n      species$background.points <- cbind(species$background.points, extract(env, species$background.points[,1:2]))\n      colnames(species$background.points) <- names\n      species$background.points <- species$background.points[complete.cases(species$background.points),]\n    } else {\n      print(\"No background points, skipping...\\n\")\n    }\n\n  } else if(\"enmtools.clade\" %in% class(species)){\n\n    # Adding env data to an entire clade\n    # All we need to do for this is call add.env for each species individually\n    for(i in 1:length(species$species)){\n      species$species[[i]] <- add.env(species$species[[i]], env)\n    }\n\n  } else {\n\n    # Not a species or clade\n    stop(\"Argument species is not an enmtools.species or enmtools.clade object!\")\n\n  }\n\n  return(species)\n\n}\n",
    "created" : 1494273908344.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3643129914",
    "id" : "DB48B751",
    "lastKnownWriteTime" : 1477882874,
    "last_content_update" : 1477882874,
    "path" : "~/GitHub/ENMTools/R/add.env.R",
    "project_path" : "R/add.env.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}